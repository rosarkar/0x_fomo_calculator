<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cost of Inaction Calculator | 0x</title>
  <meta name="description" content="Calculate how much revenue your exchange loses by delaying token listings. Built by 0x.">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; -webkit-font-smoothing: antialiased; }
    body { background: #fafafa; color: #18181b; line-height: 1.5; }
    
    .calculator-container { min-height: 100vh; padding: 0.75rem; }
    .calculator-inner { max-width: 80rem; margin: 0 auto; }
    
    .header { margin-bottom: 1rem; text-align: center; }
    .header-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: #fef2f2; border: 1px solid #fecaca; border-radius: 9999px; padding: 0.375rem 1rem; margin-bottom: 0.5rem; }
    .header-badge svg { width: 16px; height: 16px; color: #dc2626; }
    .header-badge span { color: #b91c1c; font-size: 0.875rem; font-weight: 500; }
    .header h1 { font-size: 1.25rem; font-weight: 700; color: #09090b; margin-bottom: 0.25rem; }
    .header p { color: #52525b; font-size: 0.875rem; max-width: 42rem; margin: 0 auto; }
    
    .card { background: #fff; border: 1px solid #e4e4e7; border-radius: 0.75rem; overflow: hidden; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
    .card-layout { display: flex; flex-direction: column; }
    
    .control-panel { padding: 1rem; border-bottom: 1px solid #e4e4e7; background: rgba(250,250,250,0.5); }
    .control-header { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; }
    .control-header .dot { width: 8px; height: 8px; border-radius: 50%; background: #10b981; }
    .control-header h3 { font-size: 0.75rem; font-weight: 600; color: #3f3f46; text-transform: uppercase; letter-spacing: 0.05em; }
    .control-section { margin-bottom: 1.25rem; }
    .control-section:last-child { margin-bottom: 0; }
    
    .label { font-size: 0.75rem; color: #52525b; display: flex; align-items: center; gap: 0.375rem; margin-bottom: 0.5rem; }
    .label svg { width: 14px; height: 14px; }
    .label-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
    .value { font-family: ui-monospace, monospace; font-weight: 700; font-size: 0.875rem; }
    .value-emerald { color: #047857; }
    .value-amber { color: #b45309; }
    .value-blue { color: #1d4ed8; }
    
    .presets { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.375rem; }
    .preset-btn { padding: 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 500; display: flex; flex-direction: column; align-items: center; gap: 0.125rem; border: 1px solid #d4d4d8; background: #fff; color: #52525b; cursor: pointer; transition: all 0.2s; }
    .preset-btn:hover { background: #f4f4f5; color: #18181b; }
    .preset-btn.active { background: #09090b; color: #fff; border-color: #09090b; }
    .preset-btn .emoji { font-size: 1rem; }
    
    input[type="range"] { -webkit-appearance: none; appearance: none; width: 100%; height: 8px; background: #e4e4e7; border-radius: 4px; cursor: pointer; }
    input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #18181b; box-shadow: 0 1px 3px rgba(0,0,0,0.2); cursor: pointer; }
    input[type="range"]::-moz-range-thumb { width: 18px; height: 18px; border-radius: 50%; background: #18181b; border: none; box-shadow: 0 1px 3px rgba(0,0,0,0.2); cursor: pointer; }
    .slider-emerald::-webkit-slider-thumb { background: #059669; }
    .slider-emerald::-moz-range-thumb { background: #059669; }
    .slider-amber::-webkit-slider-thumb { background: #d97706; }
    .slider-amber::-moz-range-thumb { background: #d97706; }
    .slider-blue::-webkit-slider-thumb { background: #2563eb; }
    .slider-blue::-moz-range-thumb { background: #2563eb; }
    
    .comp-markers { position: relative; height: 20px; margin-top: 0.25rem; }
    .comp-marker { position: absolute; display: flex; flex-direction: column; align-items: center; transform: translateX(-50%); }
    .comp-marker .dot { width: 6px; height: 6px; border-radius: 50%; }
    .comp-marker .name { font-size: 8px; font-weight: 500; margin-top: 2px; white-space: nowrap; }
    
    .alert { margin-top: 0.5rem; padding: 0.5rem; background: #fffbeb; border: 1px solid #fde68a; border-radius: 0.5rem; display: none; }
    .alert.show { display: block; }
    .alert p { font-size: 0.75rem; color: #92400e; }
    .alert strong { font-weight: 600; }
    
    .info-box { padding: 0.625rem; background: #fff; border: 1px solid #e4e4e7; border-radius: 0.5rem; position: relative; }
    .info-box-row { display: flex; justify-content: space-between; align-items: flex-start; gap: 0.5rem; }
    .info-box p { font-size: 0.75rem; color: #71717a; }
    .info-box strong { color: #3f3f46; font-weight: 500; }
    .info-btn { color: #a1a1aa; cursor: pointer; background: none; border: none; padding: 0; }
    .info-btn:hover { color: #52525b; }
    .info-btn svg { width: 14px; height: 14px; }
    
    .tooltip { position: absolute; bottom: 100%; left: 0; right: 0; margin-bottom: 0.5rem; padding: 0.75rem; background: #18181b; border: 1px solid #3f3f46; border-radius: 0.5rem; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); z-index: 10; display: none; }
    .tooltip.show { display: block; }
    .tooltip p { font-size: 0.75rem; color: #f4f4f5; line-height: 1.625; }
    .tooltip .highlight { color: #34d399; font-weight: 600; }
    .tooltip-arrow { position: absolute; bottom: -8px; left: 50%; transform: translateX(-50%); border: 8px solid transparent; border-top-color: #18181b; }
    
    .copy-btn { width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1rem; border-radius: 0.5rem; font-weight: 600; font-size: 0.875rem; border: 2px solid #d4d4d8; background: #fff; color: #3f3f46; cursor: pointer; transition: all 0.2s; }
    .copy-btn:hover { border-color: #a1a1aa; }
    .copy-btn.copied { background: #059669; color: #fff; border-color: #10b981; }
    .copy-btn svg { width: 16px; height: 16px; }
    
    .viz-panel { display: flex; flex-direction: column; background: #fff; }
    
    .result-section { padding: 1rem; background: #fef2f2; border-bottom: 1px solid #fee2e2; }
    .result-label { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem; }
    .result-label svg { width: 24px; height: 24px; color: #dc2626; }
    .result-label span { font-size: 0.75rem; color: #52525b; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 500; }
    .result-value { font-family: ui-monospace, monospace; font-size: 3rem; font-weight: 700; color: #dc2626; letter-spacing: -0.05em; line-height: 1; }
    .result-subtitle { font-size: 0.875rem; color: #71717a; margin-top: 0.5rem; }
    
    .stats { display: flex; flex-wrap: wrap; gap: 0.75rem; margin-top: 1rem; }
    .stat { padding: 0.5rem 1rem; border-radius: 0.5rem; text-align: center; background: #fff; border: 1px solid #e4e4e7; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
    .stat.green { background: #ecfdf5; border-color: #a7f3d0; }
    .stat-label { font-size: 0.75rem; color: #71717a; }
    .stat.green .stat-label { color: #047857; }
    .stat-value { font-family: ui-monospace, monospace; font-size: 1.125rem; font-weight: 700; }
    .stat-value.red { color: #dc2626; }
    .stat-value.amber { color: #d97706; }
    .stat-value.green { color: #047857; }
    
    .chart-section { flex: 1; padding: 1rem; }
    .chart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
    .chart-header h3 { font-size: 0.75rem; color: #71717a; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 500; }
    .chart-legend { display: flex; gap: 0.75rem; font-size: 0.75rem; }
    .chart-legend-item { display: flex; align-items: center; gap: 0.25rem; color: #71717a; }
    .chart-legend-dot { width: 8px; height: 8px; border-radius: 50%; }
    .chart-container { height: 200px; position: relative; }
    
    .comp-legend { display: flex; flex-wrap: wrap; justify-content: center; gap: 0.75rem; margin-top: 0.5rem; font-size: 0.75rem; }
    .comp-legend-item { display: flex; align-items: center; gap: 0.25rem; color: #52525b; }
    .comp-legend-item.faded { opacity: 0.4; }
    .comp-legend-line { width: 12px; height: 2px; }
    .comp-legend-x { color: #ef4444; font-weight: 700; margin-left: 2px; }
    
    .cta-section { padding: 1rem; background: #fafafa; border-top: 1px solid #e4e4e7; display: flex; flex-direction: column; gap: 0.75rem; align-items: center; text-align: center; }
    .cta-text h4 { font-size: 0.875rem; font-weight: 600; color: #18181b; margin-bottom: 0.125rem; }
    .cta-text p { font-size: 0.75rem; color: #71717a; }
    .cta-btn { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1.5rem; background: #09090b; color: #fff; font-weight: 600; font-size: 0.875rem; border-radius: 0.5rem; text-decoration: none; transition: background 0.2s; }
    .cta-btn:hover { background: #27272a; }
    .cta-btn svg { width: 16px; height: 16px; }
    
    .footer { text-align: center; font-size: 0.75rem; color: #a1a1aa; margin-top: 0.75rem; }
    .footer a { text-decoration: underline; color: #a1a1aa; }
    .footer a:hover { color: #52525b; }
    
    .text-input { width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d4d4d8; border-radius: 0.5rem; font-family: ui-monospace, monospace; font-size: 0.875rem; color: #18181b; background: #fff; display: none; }
    .text-input.show { display: block; }
    .text-input:focus { outline: none; border-color: #71717a; }
    
    @media (min-width: 768px) {
      .calculator-container { padding: 1.25rem; }
      .header h1 { font-size: 1.5rem; }
      .card-layout { flex-direction: row; }
      .control-panel { width: 35%; border-bottom: none; border-right: 1px solid #e4e4e7; padding: 1.25rem; }
      .viz-panel { width: 65%; }
      .result-section { padding: 1.25rem; text-align: left; }
      .result-value { font-size: 4.5rem; }
      .result-label { justify-content: flex-start; }
      .stats { justify-content: flex-start; }
      .chart-section { padding: 1.25rem; }
      .chart-container { height: 220px; }
      .cta-section { flex-direction: row; justify-content: space-between; text-align: left; }
    }
  </style>
</head>
<body>
  <div class="calculator-container">
    <div class="calculator-inner">
      <div class="header">
        <div class="header-badge">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>
          <span>Revenue Impact Calculator</span>
        </div>
        <h1>The Cost of Inaction</h1>
        <p>Every day you wait to list a trending token, your competitors are capturing your users' volume.</p>
      </div>

      <div class="card">
        <div class="card-layout">
          <div class="control-panel">
            <div class="control-header">
              <div class="dot"></div>
              <h3>Control Panel</h3>
            </div>

            <div class="control-section">
              <div class="label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>
                Quick Select Token
              </div>
              <div class="presets">
                <button class="preset-btn" data-name="PEPE" data-volume="500"><span class="emoji">üê∏</span><span>PEPE</span></button>
                <button class="preset-btn active" data-name="PNUT" data-volume="200"><span class="emoji">ü•ú</span><span>PNUT</span></button>
                <button class="preset-btn" data-name="GOAT" data-volume="50"><span class="emoji">üêê</span><span>GOAT</span></button>
                <button class="preset-btn" data-name="Custom" data-volume=""><span class="emoji">‚úèÔ∏è</span><span>Custom</span></button>
              </div>
              <input type="text" id="customToken" class="text-input" maxlength="10" placeholder="TOKEN" style="margin-top: 0.5rem;">
            </div>

            <div class="control-section">
              <div class="label-row">
                <span class="label">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                  Daily Volume
                </span>
                <span class="value value-emerald" id="volumeValue">$200M</span>
              </div>
              <input type="range" id="volumeSlider" class="slider-emerald" min="1" max="500" value="200">
            </div>

            <div class="control-section">
              <div class="label-row">
                <span class="label">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                  Your Listing Lag
                </span>
                <span class="value value-amber" id="lagValue">30 days</span>
              </div>
              <input type="range" id="lagSlider" class="slider-amber" min="1" max="90" value="30">
              <div class="comp-markers" id="compMarkers"></div>
              <div class="alert" id="compAlert"><p></p></div>
            </div>

            <div class="control-section">
              <div class="label-row">
                <span class="label">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="19" x2="5" y1="5" y2="19"/><circle cx="6.5" cy="6.5" r="2.5"/><circle cx="17.5" cy="17.5" r="2.5"/></svg>
                  Trading Fee
                </span>
                <span class="value value-blue" id="feeValue">0.25%</span>
              </div>
              <input type="range" id="feeSlider" class="slider-blue" min="10" max="100" value="25">
            </div>

            <div class="control-section">
              <div class="info-box">
                <div class="info-box-row">
                  <p><strong>Capture rate:</strong> 15% (conservative)</p>
                  <button class="info-btn" id="infoBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                  </button>
                </div>
                <div class="tooltip" id="tooltip">
                  <p><span class="highlight">Context:</span> Top memecoins often see 40-60% of total volume occur on-chain before major CEX listings. The 15% capture rate is a conservative baseline.</p>
                  <div class="tooltip-arrow"></div>
                </div>
              </div>
            </div>

            <button class="copy-btn" id="copyBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
              <span>Copy Memo for Leadership</span>
            </button>
          </div>

          <div class="viz-panel">
            <div class="result-section">
              <div class="result-label">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 17 13.5 8.5 8.5 13.5 2 7"/><polyline points="16 17 22 17 22 11"/></svg>
                <span>Revenue Lost on $<span id="tokenDisplay">PNUT</span></span>
              </div>
              <div class="result-value" id="lostRevenue">$225,000</div>
              <p class="result-subtitle" id="subtitle">from $900.0M missed volume over 30 days</p>
              <div class="stats">
                <div class="stat">
                  <div class="stat-label">Per Day</div>
                  <div class="stat-value red" id="perDay">$7.5K</div>
                </div>
                <div class="stat">
                  <div class="stat-label">Volume Missed</div>
                  <div class="stat-value amber" id="volumeMissed">$900.0M</div>
                </div>
                <div class="stat green">
                  <div class="stat-label">With 0x</div>
                  <div class="stat-value green" id="with0x">+$225K</div>
                </div>
              </div>
            </div>

            <div class="chart-section">
              <div class="chart-header">
                <h3>Volume Capture Timeline</h3>
                <div class="chart-legend">
                  <div class="chart-legend-item"><div class="chart-legend-dot" style="background: #059669;"></div> Market</div>
                  <div class="chart-legend-item"><div class="chart-legend-dot" style="background: #2563eb;"></div> You</div>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="chart"></canvas>
              </div>
              <div class="comp-legend" id="compLegend"></div>
            </div>
          </div>
        </div>

        <div class="cta-section">
          <div class="cta-text">
            <h4>Capture Day 1 volume without the listing process.</h4>
            <p>0x gives your users instant access to 9M+ tokens. No committee. No delays.</p>
          </div>
          <a href="https://0x.org/docs" target="_blank" rel="noopener noreferrer" class="cta-btn">
            Talk to Enterprise Team
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg>
          </a>
        </div>
      </div>

      <p class="footer">
        Calculations are illustrative. Competitor listing times are industry averages.
        ¬∑ Built by <a href="https://0x.org" target="_blank" rel="noopener noreferrer">0x</a> ¬∑ $154B+ volume since 2017
      </p>
    </div>
  </div>

  <script>
    // State
    let state = {
      dailyVolume: 200,
      listingLag: 30,
      tradingFee: 0.25,
      captureRate: 15,
      tokenName: 'PNUT',
      selectedPreset: 'PNUT'
    };

    const competitors = [
      { name: 'Binance', day: 3, color: '#f59e0b' },
      { name: 'Bybit', day: 7, color: '#8b5cf6' },
      { name: 'Kraken', day: 14, color: '#0891b2' },
      { name: 'Coinbase', day: 21, color: '#2563eb' }
    ];

    let chart = null;

    // Formatters
    function formatCurrency(value, compact = false) {
      if (compact) {
        if (value >= 1e9) return `$${(value / 1e9).toFixed(1)}B`;
        if (value >= 1e6) return `$${(value / 1e6).toFixed(1)}M`;
        if (value >= 1e3) return `$${(value / 1e3).toFixed(0)}K`;
        return `$${value.toFixed(0)}`;
      }
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(value);
    }

    // Calculations
    function calculate() {
      const lostRevenue = state.dailyVolume * 1_000_000 * state.listingLag * (state.captureRate / 100) * (state.tradingFee / 100);
      const totalMissedVolume = state.dailyVolume * state.listingLag * 1_000_000;
      return { lostRevenue, totalMissedVolume };
    }

    function generateChartData() {
      const data = { labels: [], market: [], capture: [] };
      const decay = 0.92;
      for (let day = 1; day <= 90; day++) {
        data.labels.push(day);
        const market = state.dailyVolume * ((1 - Math.pow(decay, day)) / (1 - decay));
        const capture = day > state.listingLag 
          ? (state.dailyVolume * ((1 - Math.pow(decay, day - state.listingLag)) / (1 - decay))) * (state.captureRate / 100) 
          : 0;
        data.market.push(market);
        data.capture.push(capture);
      }
      return data;
    }

    // UI Updates
    function updateUI() {
      const { lostRevenue, totalMissedVolume } = calculate();
      
      document.getElementById('volumeValue').textContent = `$${state.dailyVolume}M`;
      document.getElementById('lagValue').textContent = `${state.listingLag} days`;
      document.getElementById('feeValue').textContent = `${state.tradingFee.toFixed(2)}%`;
      document.getElementById('tokenDisplay').textContent = state.tokenName;
      document.getElementById('lostRevenue').textContent = formatCurrency(lostRevenue);
      document.getElementById('subtitle').textContent = `from ${formatCurrency(totalMissedVolume, true)} missed volume over ${state.listingLag} days`;
      document.getElementById('perDay').textContent = formatCurrency(lostRevenue / state.listingLag, true);
      document.getElementById('volumeMissed').textContent = formatCurrency(totalMissedVolume, true);
      document.getElementById('with0x').textContent = `+${formatCurrency(lostRevenue, true)}`;
      
      // Competitor alert
      const beaten = competitors.filter(c => c.day < state.listingLag);
      const alert = document.getElementById('compAlert');
      if (beaten.length > 0) {
        alert.classList.add('show');
        alert.querySelector('p').innerHTML = `<strong>${beaten[0].name}</strong> listed Day ${beaten[0].day}. They captured ${state.listingLag - beaten[0].day} days of volume before you.`;
      } else {
        alert.classList.remove('show');
      }
      
      // Competitor markers
      updateCompMarkers();
      updateCompLegend();
      updateChart();
    }

    function updateCompMarkers() {
      const container = document.getElementById('compMarkers');
      container.innerHTML = competitors.map(c => {
        const opacity = state.listingLag > c.day ? 1 : 0.3;
        return `<div class="comp-marker" style="left: ${(c.day / 90) * 100}%; opacity: ${opacity};">
          <div class="dot" style="background: ${c.color};"></div>
          <span class="name" style="color: ${c.color};">${c.name}</span>
        </div>`;
      }).join('');
    }

    function updateCompLegend() {
      const container = document.getElementById('compLegend');
      container.innerHTML = competitors.map(c => {
        const late = state.listingLag > c.day;
        return `<div class="comp-legend-item ${late ? '' : 'faded'}">
          <div class="comp-legend-line" style="background: ${late ? c.color : 'transparent'}; border-top: ${late ? 'none' : `1px dashed ${c.color}`};"></div>
          <span>${c.name} D${c.day}</span>
          ${late ? '<span class="comp-legend-x">‚úó</span>' : ''}
        </div>`;
      }).join('');
    }

    function updateChart() {
      const data = generateChartData();
      
      // Build annotations for competitor lines
      const annotations = {};
      competitors.forEach((c, i) => {
        const late = state.listingLag > c.day;
        annotations[`comp${i}`] = {
          type: 'line',
          xMin: c.day,
          xMax: c.day,
          borderColor: c.color,
          borderWidth: late ? 2 : 1,
          borderDash: late ? [] : [4, 4],
          label: late ? {
            display: true,
            content: `${c.name}`,
            position: 'start',
            backgroundColor: 'transparent',
            color: c.color,
            font: { size: 9, weight: 600 }
          } : { display: false }
        };
      });
      
      // User's listing line
      annotations.userLine = {
        type: 'line',
        xMin: state.listingLag,
        xMax: state.listingLag,
        borderColor: '#dc2626',
        borderWidth: 2,
        borderDash: [6, 3],
        label: {
          display: true,
          content: `You: Day ${state.listingLag}`,
          position: 'start',
          backgroundColor: 'transparent',
          color: '#dc2626',
          font: { size: 10, weight: 'bold' }
        }
      };

      if (chart) {
        chart.data.labels = data.labels;
        chart.data.datasets[0].data = data.market;
        chart.data.datasets[1].data = data.capture;
        chart.options.plugins.annotation.annotations = annotations;
        chart.update('none');
      } else {
        const ctx = document.getElementById('chart').getContext('2d');
        chart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: data.labels,
            datasets: [
              {
                label: 'Market Volume',
                data: data.market,
                borderColor: '#059669',
                backgroundColor: 'rgba(5, 150, 105, 0.1)',
                fill: true,
                tension: 0.4,
                pointRadius: 0
              },
              {
                label: 'Your Capture',
                data: data.capture,
                borderColor: '#2563eb',
                backgroundColor: 'rgba(37, 99, 235, 0.1)',
                fill: true,
                tension: 0.4,
                pointRadius: 0
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: { intersect: false, mode: 'index' },
            plugins: {
              legend: { display: false },
              annotation: { annotations },
              tooltip: {
                backgroundColor: '#fff',
                titleColor: '#18181b',
                bodyColor: '#71717a',
                borderColor: '#e4e4e7',
                borderWidth: 1,
                padding: 12,
                callbacks: {
                  label: ctx => `${ctx.dataset.label}: ${formatCurrency(ctx.raw * 1e6, true)}`
                }
              }
            },
            scales: {
              x: {
                grid: { color: '#f4f4f5' },
                ticks: { color: '#71717a', font: { size: 9 } }
              },
              y: {
                grid: { color: '#f4f4f5' },
                ticks: { 
                  color: '#71717a', 
                  font: { size: 9 },
                  callback: v => `$${v}M`
                }
              }
            }
          }
        });
      }
    }

    function generateReport() {
      const { lostRevenue, totalMissedVolume } = calculate();
      const beaten = competitors.filter(c => c.day < state.listingLag);
      const compLines = beaten.length > 0
        ? beaten.map(c => `  - ${c.name}: Listed Day ${c.day} (${state.listingLag - c.day} days ahead)`).join('\n')
        : '  - None. You beat all major competitors to market.';
      
      return `INTERNAL MEMO: OPPORTUNITY COST ANALYSIS
============================================

DATE: ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
PREPARED BY: Trading Infrastructure Team

ASSET ANALYZED
--------------
Token: ${state.tokenName}
Estimated Daily Launch Volume: ${formatCurrency(state.dailyVolume * 1e6, true)}
Your Listing Timeline: ${state.listingLag} days post-launch
Applied Trading Fee: ${state.tradingFee.toFixed(2)}%
Capture Rate Assumption: ${state.captureRate}% (conservative baseline)

REVENUE FOREGONE
----------------
Estimated Lost Fee Revenue: ${formatCurrency(lostRevenue)}
Total Missed Trading Volume: ${formatCurrency(totalMissedVolume, true)}
Daily Revenue Impact: ${formatCurrency(lostRevenue / state.listingLag, true)}/day

COMPETITIVE BENCHMARKS
----------------------
Exchanges that listed before your Day ${state.listingLag} timeline:
${compLines}

RECOMMENDATION
--------------
Evaluate integration of hybrid trading infrastructure (e.g., 0x RFQ + AMM aggregation) to capture pre-listing volume without committee approval delays.

NEXT STEPS
----------
Contact 0x Enterprise Team: enterprise@0x.org
Documentation: https://0x.org/docs

============================================
Generated by 0x Cost of Inaction Calculator`;
    }

    // Event Listeners
    document.querySelectorAll('.preset-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        const name = btn.dataset.name;
        const volume = btn.dataset.volume;
        
        state.selectedPreset = name;
        
        if (name === 'Custom') {
          document.getElementById('customToken').classList.add('show');
        } else {
          document.getElementById('customToken').classList.remove('show');
          state.tokenName = name;
          state.dailyVolume = parseInt(volume);
          document.getElementById('volumeSlider').value = volume;
        }
        updateUI();
      });
    });

    document.getElementById('customToken').addEventListener('input', e => {
      state.tokenName = e.target.value.toUpperCase() || 'TOKEN';
      updateUI();
    });

    document.getElementById('volumeSlider').addEventListener('input', e => {
      state.dailyVolume = parseInt(e.target.value);
      document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
      document.querySelector('.preset-btn[data-name="Custom"]').classList.add('active');
      document.getElementById('customToken').classList.add('show');
      updateUI();
    });

    document.getElementById('lagSlider').addEventListener('input', e => {
      state.listingLag = parseInt(e.target.value);
      updateUI();
    });

    document.getElementById('feeSlider').addEventListener('input', e => {
      state.tradingFee = parseInt(e.target.value) / 100;
      updateUI();
    });

    document.getElementById('infoBtn').addEventListener('click', () => {
      document.getElementById('tooltip').classList.toggle('show');
    });

    document.getElementById('copyBtn').addEventListener('click', () => {
      const report = generateReport();
      navigator.clipboard.writeText(report).then(() => {
        const btn = document.getElementById('copyBtn');
        btn.classList.add('copied');
        btn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6 9 17l-5-5"/></svg><span>Copied to Clipboard</span>`;
        setTimeout(() => {
          btn.classList.remove('copied');
          btn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg><span>Copy Memo for Leadership</span>`;
        }, 3000);
      });
    });

    // Init
    updateUI();
  </script>
</body>
</html>
